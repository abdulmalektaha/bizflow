<?php
// ===================================================
// [1. إعدادات الأمان وتسجيل الأخطاء]
// ===================================================
ini_set('display_errors', 0); // [هام] إيقاف عرض الأخطاء للمستخدم
ini_set('display_startup_errors', 0); // [هام] إيقاف عرض أخطاء البدء
error_reporting(E_ALL);

// [هام] هذان السطران سيسجلان أي خطأ في ملف خاص بدلاً من عرضه
ini_set('log_errors', 1);
ini_set('error_log', '/var/www/html/php_errors.log'); // ملف السجل الخاص بنا


// ===================================================
// [2. إعدادات المفاتيح (API Keys)]
// ===================================================

// !! هام جدًا: تأكد من أن هذا هو التوكن الحقيقي لبوتك !!
define('TELEGRAM_BOT_TOKEN', '8464809764:AAE7Rv4Iu2_Rq0eCcxN9QwqF_3iundvsq90'); // تم استخدام التوكن الذي أعطيتني إياه

// !! هام جدًا: ضع مفتاح OpenAI الحقيقي هنا إذا كنت ستستخدمه !!
define('OPENAI_API_KEY', 'sk-proj-jMlhCS7q4TfTS4c_SUMDPR5cwveEj6VRnVJG89T3BlbkFJxE2XgZvjXQMDnGiSIHdfWE-AzXx4o_9PoyN3WTW7_xcBUGP5vwFS3dy7r9l7pqboUw0A'); // تم استخدام المفتاح الذي أعطيتني إياه

// !! هام جدًا: تأكد من أن هذا هو الـ Chat ID الصحيح للإدارة !!
define('MANAGEMENT_CHAT_ID', '7751190692'); // تم استخدام الـ ID الذي أعطيتني إياه


// ===================================================
// [3. إعدادات الاتصال بقاعدة البيانات (PostgreSQL)]
// ===================================================

// هذه هي الإعدادات التي قمنا بضبطها على السيرفر
$db_host = '127.0.0.1'; // يعني "هذا السيرفر"
$db_name = 'bizflow_db';
$db_user = 'postgres'; // المستخدم الافتراضي لـ PostgreSQL
$db_pass = 'qweasd123@!'; // !! كلمة المرور الصحيحة التي قمنا بتعيينها !!


// ===================================================
// [4. كود الاتصال بقاعدة البيانات (مع معالجة الأخطاء)]
// ===================================================

$db_connection = null; // تعريف المتغير أولاً

try {
    // هذا هو سطر الاتصال الصحيح لـ PostgreSQL
    $conn_string = "pgsql:host=$db_host;dbname=$db_name";
    
    // محاولة الاتصال
    $db_connection = new PDO($conn_string, $db_user, $db_pass);
    
    // [هام] ضبط وضع معالجة الأخطاء لرمي الاستثناءات (Exceptions)
    // هذا يسمح لنا بالتقاط الأخطاء باستخدام try...catch في الملفات الأخرى
    $db_connection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

} catch (PDOException $e) {
    // إذا فشل الاتصال الأولي بقاعدة البيانات هنا، فهذه مشكلة كبيرة
    // نقوم بتسجيل الخطأ في السجل الخاص بنا
    error_log("!! CRITICAL DATABASE CONNECTION ERROR (config.php): " . $e->getMessage()); 
    
    // يمكنك اختيار إيقاف الكود تمامًا هنا أو التعامل معه لاحقًا
    // die("فشل الاتصال بقاعدة البيانات بشكل حرج. يرجى مراجعة سجل الأخطاء."); // يمكنك تفعيل هذا السطر إذا أردت
    
    // ترك $db_connection = null سيجعل الكود في الملفات الأخرى يتعامل مع الخطأ
}

?>
